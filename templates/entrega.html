{% load static %}
<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="{% static 'Bootstrap/css/bootstrap.min.css' %}">
    <link rel="stylesheet" href="{% static 'css/index.css' %}" type="text/css">
    <link rel="stylesheet" href="{% static 'css/entrega.css' %}" type="text/css">
    <script src="https://kit.fontawesome.com/712575d4a5.js" crossorigin="anonymous"></script>
    <script src="https://kit.fontawesome.com/d6c2ac0aaf.js" crossorigin="anonymous"></script>
    <link rel="shortcut icon" href="{% static 'images/ATTIRE FAVICON.png' %}" type="image/x-icon">
    <title>Entregas</title>
</head>
<body>
    <header id="header" class="col-12  w-100 shadow">
      <div id="header-wrap" class="col-11 d-flex h-100 gap-5 align-items-center justify-content-between mx-auto">
          <div class="flex-grow-1 fs-4" id="dash">
              <label class="switch-container">
                  <input type="checkbox">
              </label>
          </div>
          <div class="col-3 flex-grow-1" id="imagen-logo">
              <img src="{% static 'images/logo.png' %}" alt="" class="imagenlogo">
          </div>
          <!--Inicio barra de buscar-->
          <nav class="navbar bg-body-tertiary flex-grow-2">
          </nav>
          <!--Inicio barra de buscar-->
          <div id="iconos" class="d-flex gap-3 flex-grow-3 fs-4">

              <!--Seccion de iconos del header-->
              <button tabindex="0" class="usuario" type="checkbox" data-container="body" data-bs-toggle="popover"
                  data-bs-placement="bottom" data-bs-html="true" data-bs-animation="true" data-bs-trigger="focus"
                  data-bs-content="
                  {% if datos_usuario %}
                        <p class='text-icons fw-bold fs-4 text-center mb-3'>Bienvenido, {{ datos_usuario.username }}.</p>
                            <a href='{% url 'logout' %}' class='boton-icons btn rounded-pill mb-2'>Cerrar Sesion</a>
                    {% if es_superuser %}
                        <a href='{% url 'admin:index' %}' class='boton-icons btn rounded-pill mb-2'>Admin</a>
                    {% endif %}
                    {% else %}
                        <p class='text-icons fw-bold fs-4 text-center mb-3'>Tal parece que aun no has iniciado sesion 😕</p>
                            <a href='{% url 'registro' %}' class='boton-icons btn rounded-pill mb-2'>Registrarse</a>
                            <a href='{% url 'login' %}' class='boton-icons btn rounded-pill mb-2'>Iniciar sesion</a>
                    {% endif %}">

                  <i class="fa-solid fa-user"></i>
              </button>
              <button tabindex="0" type="button" class="carrito-Compras" data-container="body"
                  data-bs-toggle="popover" data-bs-placement="bottom" data-bs-html="true" data-bs-animation="true"
                  data-bs-trigger="focus" data-bs-content="
                      <div class='mt-3 w-75 mx-auto'>
                      <p class='text-icons fw-bold fs-6 text-center'>Revisa los productos que tienes en tu carrito de compras</p>
                      <a href='{% url 'carrito' %}' class='boton-icons btn rounded-pill '>Ver mi carrito de compras</a>
                      </div>">
                  <i class="fa-solid fa-cart-shopping"></i>
              </button>

              <button tabindex="0" class="reportes" type="button" data-container="body" data-bs-toggle="popover"
                  data-bs-placement="bottom" data-bs-html="true" data-bs-animation="true" data-bs-trigger="focus"
                  data-bs-content="
      <div class='reporte-icon mt-3 w-75 mx-auto'>
          <p id='reporte-p' class='fw-bold fs-5 text-center'>¿tienes alguna petición, queja, reclamo o sugerencia? no dudes en comentarnos tu situacion</p>
          <a href='{% url 'pqrs' %}' class='boton-icons btn rounded-pill ms-3'>Hacer un reporte</a>
          <a href='{% url 'mostrar_pqrs' %}' class='boton-icons btn rounded-pill ms-3 mt-2'>Ver mis reportes</a>
      </div>"><i class="fa-solid fa-bell"></i></button>
          </div>
      </div>
  </header>

<!-- modal para crear direccion -->
<div class="modal fade" id="ModalCrearDireccion" data-bs-keyboard="false" data-bs-backdrop="static" tabindex="-1" aria-labelledby="staticBackdropLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h1 class="modal-title fs-5" id="staticBackdropLabel">Agregar Dirección</h1>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Cerrar"></button>
      </div>
      <div class="modal-body">
        <form action="#" method="post">
          {% csrf_token %}
          {% for campo in form_crear_entrega %}
            <label for="" class="form-label">{{ campo.label }}</label>
            {% if campo.name == 'locality' %}
              <select class="form-control" name="{{ campo.name }}" required>
                {% for value, label in campo.field.choices %}
                  <option value="{{ value }}" {% if campo.value == value %} selected {% endif %} title="Todos los campos son requeridos."> {{ label }} </option>
                {% endfor %}
              </select>
            {% else %}
            <input type="{{ campo.field.widget.input_type }}" 
                    class="form-control" 
                    name="{{ campo.name }}"
                    aria-describedby="helpId" 
                    placeholder="{{ campo.label }}"
                    required
                    title="Todos los campos son requeridos.">
            {% endif %}
          {% endfor %}
      </div>
      <div class="modal-footer d-flex justify-content-around align-items-center">
        <button type="button" class="btn btn-elim-canc" data-bs-dismiss="modal">Cancelar</button>
        <button type="submit" href="#" class="btn boton-gradient">Crear dirección</button>
      </form>
      </div>
    </div>
  </div>
</div>
<!-- fin modal para crear direccion -->

<!-- modal para editar direccion -->
<div class="modal fade" id="ModalEditarDireccion" data-bs-keyboard="false" data-bs-backdrop="static" tabindex="-1" aria-labelledby="staticBackdropLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h1 class="modal-title fs-5" id="staticBackdropLabel">Editar Dirección</h1>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Cerrar"></button>
      </div>
      <div class="modal-body">
          <form action="#" method="post">
            {% csrf_token %}
            {% for campo in form_editar_entrega %}
              <label for="" class="form-label">{{ campo.label }}</label>
              {% if campo.name == 'locality' %}
                <select class="form-control" name="{{ campo.name }}" required>
                  {% for value, label in campo.field.choices %}
                    <option value="{{ value }}" {% if campo.value == value %} selected {% endif %} title="Todos los campos son requeridos."> {{ label }} </option>
                  {% endfor %}
                </select>
              {% else %}
              <input type="{{ campo.field.widget.input_type }}"
                      class="form-control"
                      name="{{ campo.name }}"
                      aria-describedby="helpId"
                      placeholder="{{ campo.label }}"
                      required
                      value="{{ campo.value | default:"" }}"
                      title="Todos los campos son requeridos.">
              {% endif %}
            {% endfor %}
        </div>
        <div class="modal-footer d-flex justify-content-around align-items-center">
          <button class="btn btn-elim-canc" data-bs-dismiss="modal">Cancelar</button>
          <button href="#" type="submit" class="btn boton-gradient">Editar dirección</button>
        </div>
    </form>
    </div>
  </div>
</div>
<!-- fin modal para editar direccion -->

{% if datos_usuario.address and datos_usuario.zip_code and datos_usuario.locality %}

<!-- contenido de la pagina -->
<section class="container-fluid h-100">
  <h1 class="text-center mt-5">TUS DIRECCIONES</h1>
  <div class="row card_edit">
    <div class="col-5 mx-auto">
      <div class="card">
        <h5 class="card-header text-center titulo-card-entrega">Dirección</h5>
        <div class="card-body">
          <h5 class="card-title titulo-card-entrega">Dirección:</h5>
          <p class="card-text texto-resultado fw-bold">{{ datos_usuario.address | default:"" }}</p>
          <h5 class="card-title titulo-card-entrega">Código postal:</h5>
          <p class="card-text texto-resultado fw-bold">{{ datos_usuario.zip_code | default:"" }}</p>
          <h5 class="card-title titulo-card-entrega">Localidad: </h5>
          <p class="card-text mb-3 texto-resultado fw-bold">{{ datos_usuario.locality.locality_names | default:"" }}</p>
          <div class="row justify-content-around">
            <div class="col-auto">
              <button class="btn boton-gradient" data-bs-toggle="modal" data-bs-target="#ModalEditarDireccion" data-id="{{ datos_usuario.id }}">Editar dirección</button>
            </div>
            <form class="col-auto" action="{% url 'entrega' %}" method="post">
              {% csrf_token %}
              <button type="submit" class="btn btn-elim-canc">Eliminar</button>
            </form>
          </div>
        </div>
      </div>
    </div>
  </div>
    <div class="row d-flex justify-content-center align-items-center bajar-boton">
        <div class="col-6 text-center">
            <a href="{% url 'comprater' %}"><button class="btn btn-terminar-compra text-center" type="button">Terminar compra</button></a>
        </div>
    </div>
</section>
 {% else %}
<section class="container-fluid h-100">
    <h1 class="text-center mt-5">TUS DIRECCIONES</h1>
    <div class="sin-info-back row justify-content-center align-items-center mt-5">
        <div class="sin-info text-center">
            <h2 class="texto_no_datos">No tienes dirección asignada. <br>Crea una dando clic en el botón 'Agregar dirección'.</h2>
        </div>
    </div>
    <div class="row btn_act_modal">
        <div class="col-9"></div>
        <div class="col-3 text-end">
            <button href="" type="button" class="btn boton-gradient d-flex justify-content-end" data-bs-toggle="modal" data-bs-target="#ModalCrearDireccion">
                Agregar<br>dirección
            </button>
        </div>
    </div>
{% endif %}
<!-- fin contenido de la pagina -->

<!-- pie de pagina -->
<footer class="col-12 d-flex justify-content-center align-items-center w-100 pie">
    <ul class="row col-9 text-center mt-2">
        <li class="col foot"><a href="{% url 'index' %}">AYUDA</a></li>
        <li class="col foot"><a href="{% url 'pqrs' %}">CONTACTANOS</a></li>
        <li class="col foot"><a href="{% url 'index' %}">ACERCA DE NOSOTROS</a></li>
    </ul> 
</footer>
<!-- fin pie de pagina -->

    <script src="{% static 'Bootstrap/js/bootstrap.bundle.min.js' %}"></script>
    <script src="{% static 'js/popovers.js' %}"></script>
    <script src="{% static 'js/jquery-3.6.3.min.js' %}"></script>
    <script src="{% static 'js/popper.min.js' %}"></script>
</body>
</html>